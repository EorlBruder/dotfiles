% Set header in a box
\newcommand{\titleLogo}{\raisebox{-0.2\height}{\logoRendered{1.5cm}}}

\usepackage{xstring}

\def\basiceval#1{\the\numexpr#1\relax}
\newcommand{\newsletterTitle}{
  \ifthenelse{\equal{\MyTitle}{}}{
    \ifthenelse{\equal{\logopath}{}}{
      Newsletter
    }{
      \titleLogo
    }
  }{
    \ifthenelse{\equal{\logopath}{}}{
      \MyTitle
    }{
      \StrCount{\MyTitle}{ }[\spacesInTitle]
      \ifodd \spacesInTitle 
        \let \spacesInTitleOld \spacesInTitle
        \renewcommand{\spacesInTitle}{\basiceval{\spacesInTitleOld - 1}}
      \fi
      \StrCut[\basiceval{(\spacesInTitle+2)/2}]{\MyTitle}{ }\firstPart\secondPart
      \firstPart \titleLogo \secondPart
    }
  }
}

\newcommand{\themeHeaderHook}{
  \begin{fancyTitleBox}
    % Latex is weirdly gobbling up chars here...
    .
    \ifcsname newsletterTitle\endcsname
      \newsletterTitle
    \else
      \logotext 
    \fi
  \end{fancyTitleBox}
}

% Let sections be in boxes
\newcommand{\themeFinalHook}{
  \usepackage{ifthen}
  \newboolean{alreadyCalled}
  \setboolean{alreadyCalled}{false}

  \renewcommand{\maketitle}{}
  
  \renewcommand{\section}[1]{
    \ifthenelse{\boolean{alreadyCalled}}{
      \end{fancyBox}
      \begin{fancyBox}{##1}
    }{
      \begin{fancyBox}{##1}
    }
    \setboolean{alreadyCalled}{true}
  }

  \LetLtxMacro\enddocumentOld\enddocument

  \renewcommand{\enddocument}{
    \ifthenelse{\boolean{alreadyCalled}}{
      \end{fancyBox}
    }{}
    \end{documentOld}
  }
}

% Set bigger gap between columsn
\setlength{\columnsep}{1cm}
